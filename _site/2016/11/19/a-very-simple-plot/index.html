<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Personal blog of Osvaldo Zagordi, data scientist at University of Zurich and founder of enGene Statistics. Data science, statistics, science, machine learning, python, R and so on.
">

    <title>A very simple plot - Sharp Bell</title>

    <link rel="canonical" href="https://ozagordi.github.io/2016/11/19/a-very-simple-plot/">

    <!-- Custom JavaScript files set in YAML front matter -->
    

    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        styles: { ".MathJax": { color: "#657b83" } }
      });
    </script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <link href="https://fonts.googleapis.com/css?family=Abel" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <link type="application/atom+xml" rel="alternate" href="https://ozagordi.github.io/feed.xml" title="Sharp Bell" />

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Sharp Bell</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
                
				
                <li>
                    <a href="/about/">About</a>
                </li>
				
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header" style="background-image: url('/img/alps.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>A very simple plot</h1>
                    
                    <span class="meta">Posted by Osvaldo on November 19, 2016</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

				<p>If you look at the front cover of <em>The Visual Display of Quantitative Information</em>,
one of the famous books by Eduard Tufte, you will see a plot made of many
lines. An intricate network of red lines of different thickness,
cutting diagonally a regular grey grid.</p>

<p><img src="https://www.edwardtufte.com/tufte/graphics/vdqi_bookcover.gif" alt="VDQI bookcover" class="center-block" /></p>

<p>The plot is one of the examples of the first chapter, <em>Graphical Excellence</em>,
and it is a graphical train schedule for Paris to Lyon in 1880s, by
<a href="https://en.wikipedia.org/wiki/Étienne-Jules_Marey">Étienne-Jules Marey</a>. The
station are arranged vertically (the top one being Paris) at a distance
proportional to their actual distance, while time is on the horizontal axis. Each
line is a train, and the slope is the speed. It took around nine hours for the
entire trip but the TGV, first introduced in 1981, completes the trip in less
than three hours. A red line overlayed on the schedule of 100 years before
marks the progress made.</p>

<p><img src="/img/marey_tgv.jpg" alt="Marey's schedule with TGV overlaid" class="center-block" /></p>

<p>I like these plots because of their simplicity: position vs. time; something I
must have seen for the first time in secondary school or even earlier. Angle,
slope, tangent, derivative, speed, everything is there, you just name it
differently in different moments of your education.</p>

<p>I decided to reproduce this plot for the Zurich-Milano train connection, which
is about to experience an historical moment. In a few weeks, all passenger trains
on this line will be traveling in the
<a href="https://en.wikipedia.org/wiki/Gotthard_Base_Tunnel">Gotthard Base Tunnel</a>.
It is the world’s longest tunnel, running along more than 57 km under the Swiss
Alps at an altitude between 469 and 312 m. Trains currently travel through
another tunnel, the
<a href="https://en.wikipedia.org/wiki/Gotthard_Tunnel">Gotthard Tunnel</a>, 15 km long,
built at the end of 19th century at an altitude of around 1,100 m. In order
to climb to that altitude, trains travel through several railway spirals.
The view is great, but the speed is not.</p>

<p>I downloaded the schedule for a few morning trains that go through the
<em>Panoramastrecke</em> (the panoramic track) and a few that will go through the
base tunnel, they are shown in the plot below. It might not look that impressive
compared to the TGV. But if you look at the mountains while approaching them
from the plain, it’s a different feeling.</p>

<p><img src="/img/gotthard_trains.svg" alt="Trains schedule Zurich-Milano" class="center-block" /></p>

<p><a href="https://www.alptransit.ch/en/media/press-releases/detail/article/memorial-ceremony-for-deceased-tunnel-workers/">Nine people died</a>
during construction of the Gotthard Base Tunnel. None of them was of Swiss nationality.</p>

<p>Below is the R code used to produce the schedule plot. The timetable for a few train
was obtained on the SBB <a href="http://www.sbb.ch">website</a> and manually written into
a <a href="https://github.com/ozagordi/ozagordi.github.io/blob/gh-pages/_source/train_gotthard/timetable-table.csv">csv file</a>.
The coordinates of the cities were taken on Google Maps and saved
<a href="https://github.com/ozagordi/ozagordi.github.io/blob/gh-pages/_source/train_gotthard/coordinates-table.csv">here</a>.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">ggthemr</span><span class="p">)</span><span class="w">
</span><span class="n">ggthemr</span><span class="p">(</span><span class="s1">'solarized'</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s1">'outer'</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">geosphere</span><span class="p">)</span><span class="w">

</span><span class="c1"># parse coordinates and compute distances
</span><span class="n">coordinates_table</span><span class="w"> </span><span class="o">&lt;-</span><span class="w">
  </span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"train_gotthard/coordinates-table.csv"</span><span class="p">)</span><span class="w">
</span><span class="n">cities</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">coordinates_table</span><span class="o">$</span><span class="n">city</span><span class="w">
</span><span class="n">coordinates_table</span><span class="o">$</span><span class="n">city</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NULL</span><span class="w">
</span><span class="n">p</span><span class="m">1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.matrix</span><span class="p">(</span><span class="n">coordinates_table</span><span class="p">)</span><span class="w">
</span><span class="n">p</span><span class="m">2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="n">p</span><span class="m">1</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">cities</span><span class="p">)),</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="n">p</span><span class="m">1</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">cities</span><span class="p">))),</span><span class="w"> </span><span class="n">ncol</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">dists</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">distHaversine</span><span class="p">(</span><span class="n">p</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="m">2</span><span class="p">)</span><span class="w">

</span><span class="n">trains</span><span class="w"> </span><span class="o">&lt;-</span><span class="w">
  </span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"train_gotthard/timetable-table.csv"</span><span class="p">,</span><span class="w">
          </span><span class="n">col_types</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cols</span><span class="p">(</span><span class="n">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col_character</span><span class="p">(),</span><span class="w">
                           </span><span class="n">time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col_character</span><span class="p">(),</span><span class="w">
                           </span><span class="n">train</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col_character</span><span class="p">(),</span><span class="w">
                           </span><span class="n">track</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col_character</span><span class="p">()))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">as.POSIXct</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="w"> </span><span class="n">format</span><span class="o">=</span><span class="s2">"%H:%M"</span><span class="p">))</span><span class="w">
</span><span class="n">distances</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data_frame</span><span class="p">(</span><span class="n">city</span><span class="o">=</span><span class="n">cities</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="o">=</span><span class="n">dists</span><span class="p">)</span><span class="w">

</span><span class="n">trains</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">trains</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">full_join</span><span class="p">(</span><span class="n">distances</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="o">=</span><span class="s2">"city"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">train_track</span><span class="o">=</span><span class="n">paste</span><span class="p">(</span><span class="n">train</span><span class="p">,</span><span class="w"> </span><span class="n">track</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="o">=</span><span class="s1">'_'</span><span class="p">))</span><span class="w">

</span><span class="n">cbPalette</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"#657b83"</span><span class="p">,</span><span class="w"> </span><span class="s2">"#268bd2"</span><span class="p">)</span><span class="w">
</span><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">trains</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">time</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">group</span><span class="o">=</span><span class="n">train_track</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="o">=</span><span class="n">track</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_y_continuous</span><span class="p">(</span><span class="n">breaks</span><span class="o">=</span><span class="n">distances</span><span class="o">$</span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">=</span><span class="n">distances</span><span class="o">$</span><span class="n">city</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_x_datetime</span><span class="p">(</span><span class="n">date_breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"1 hour"</span><span class="p">,</span><span class="w"> </span><span class="n">date_labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"%H:%M"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">xlab</span><span class="p">(</span><span class="s1">''</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="s1">''</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">axis.title.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">15</span><span class="p">),</span><span class="w">
        </span><span class="n">axis.text.x</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">15</span><span class="p">),</span><span class="w">
        </span><span class="n">axis.title.y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">15</span><span class="p">),</span><span class="w">
        </span><span class="n">axis.text.y</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">15</span><span class="p">),</span><span class="w">
        </span><span class="n">legend.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">15</span><span class="p">),</span><span class="w">
        </span><span class="n">legend.text</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">15</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_colour_manual</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">cbPalette</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p>Header image via <a href="https://flic.kr/p/q8P66v">Flickr</a> (under CC BY-ND 2.0).</p>


                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2016/10/08/breaking-ground/" data-toggle="tooltip" data-placement="top" title="Breaking ground">&larr; Previous Post</a>
                    </li>
                    
                    
                </ul>

            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="https://twitter.com/ozagordi">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://www.linkedin.com/in/osvaldozagordi">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    <li>
                        <a href="https://github.com/ozagordi">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="mailto:firstname.lastname@gmail.com">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">Copyright &copy; Osvaldo Zagordi 2016</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>


    
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-80133486-1', 'auto');
  ga('send', 'pageview');

</script>



</body>

</html>
